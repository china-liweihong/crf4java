增加并行，优化CPU和内存利用
有BUG，空闲时优化
